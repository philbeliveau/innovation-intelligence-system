# Story 1.1: Landing Page with Company Selection

**Epic:** Epic 1 - Core Upload & File Management
**Priority:** P0
**Estimated Time:** 1.5 hours

---

## Status

**Draft**

---

## Story

**As a** Innovation Manager,
**I want** to select my company by typing its name on a visually engaging landing page,
**so that** the system loads my brand context and personalizes my innovation pipeline experience.

---

## Acceptance Criteria

1. Page displays "My Board of Ideators" as centered title with "My" in teal italics
2. 8 colored circles arranged in circular pattern around center (2 each: teal, blue, yellow, orange)
3. Central white rectangular text input (400-500px width, 50-60px height) with placeholder: "Lactalis, Columbia, Decathlon, McCormick..."
4. Top navigation tabs: "Everything" | "Spaces" | "Serendipity" (right-aligned, visual only)
5. User can type company name into central input field (case-insensitive)
6. Validation triggers on Enter key press or input blur
7. Accepted values map correctly: "lactalis" → `lactalis-canada`, "columbia" → `columbia-sportswear`, "decathlon" → `decathlon`, "mccormick" → `mccormick-usa`
8. Invalid input shows error message: "Company not found. Please try: Lactalis, Columbia, Decathlon, or McCormick"
9. Loading spinner displays in input during API call
10. On valid company name submission, call `POST /api/onboarding/set-company`
11. API loads corresponding YAML file from `/data/brand-profiles/{company-id}.yaml`
12. API sets HTTP-only cookie: `company_id={company-id}` with 7-day expiry
13. API returns company name and basic profile data (200 status)
14. On success, redirect to `/upload` page
15. On error, display validation error and keep user on page
16. YAML files in `/data/brand-profiles/` remain unmodified
17. Python CLI pipeline can still read YAML files directly (no breaking changes)
18. API route location: `app/api/onboarding/set-company/route.ts`
19. API uses Next.js `cookies()` API from `next/headers`
20. Invalid input preserves user's typed text
21. Error message clears on new input attempt
22. No page flicker or layout shift during loading state
23. Input field has proper `aria-label`: "Company name"
24. Error messages have `role="alert"` for screen readers
25. Input focus state shows teal border
26. Tab navigation works correctly through all interactive elements
27. Visual design matches reference image `docs/image/Landing-page.png` (90%+ similarity)
28. Page is responsive (desktop only - mobile out of scope)
29. No console errors or warnings in browser
30. TypeScript compilation passes with no errors

---

## Tasks / Subtasks

- [ ] Task 1: Create page component structure (AC: 1, 2, 3, 4)
  - [ ] Create `app/page.tsx` as root route component
  - [ ] Add page title "My Board of Ideators" with styled "My" in teal italics
  - [ ] Implement 8 colored circles with CSS Grid or absolute positioning
  - [ ] Add top navigation tabs (Everything, Spaces, Serendipity)
  - [ ] Set light gray/off-white background with subtle texture

- [ ] Task 2: Create company input component (AC: 3, 5, 8, 20, 21, 23, 25, 26)
  - [ ] Create `components/CompanyInput.tsx` with text input
  - [ ] Add placeholder text: "Lactalis, Columbia, Decathlon, McCormick..."
  - [ ] Style input: 400-500px width, 50-60px height, white background
  - [ ] Add focus state with teal border
  - [ ] Add `aria-label="Company name"`
  - [ ] Implement keyboard navigation (Tab, Enter)
  - [ ] Preserve input text on validation error
  - [ ] Clear error message on new input

- [ ] Task 3: Implement validation logic (AC: 5, 6, 7, 8, 9, 20)
  - [ ] Create company name mapping object: lactalis→lactalis-canada, columbia→columbia-sportswear, decathlon→decathlon, mccormick→mccormick-usa
  - [ ] Add case-insensitive input normalization (toLowerCase + trim)
  - [ ] Trigger validation on Enter key press
  - [ ] Trigger validation on input blur
  - [ ] Display error message for invalid company names
  - [ ] Show loading spinner during API call

- [ ] Task 4: Create API route for company loading (AC: 10, 11, 12, 13, 16, 17, 18, 19)
  - [ ] Create `app/api/onboarding/set-company/route.ts`
  - [ ] Implement POST handler accepting `{company_id: string}`
  - [ ] Validate company_id against allowed list: ['lactalis-canada', 'mccormick-usa', 'columbia-sportswear', 'decathlon']
  - [ ] Load YAML file from `data/brand-profiles/{company_id}.yaml` using `readFile` from 'fs/promises'
  - [ ] Parse YAML using `parse` from 'yaml' package
  - [ ] Set HTTP-only cookie using `cookies().set()` from 'next/headers'
  - [ ] Cookie config: httpOnly=true, maxAge=604800 (7 days), sameSite='lax', path='/'
  - [ ] Return JSON: `{company_name: profile.brand_name, company_id}`
  - [ ] Handle errors: 400 for invalid company_id, 500 for file read/parse errors
  - [ ] Log errors server-side with console.error

- [ ] Task 5: Implement redirect on success (AC: 14, 15, 22)
  - [ ] Use Next.js `useRouter().push('/upload')` on successful API response
  - [ ] Keep user on page if API returns error
  - [ ] Display error message from API response
  - [ ] Ensure no layout shift during state transitions

- [ ] Task 6: Create supporting components (AC: 2, 4)
  - [ ] Create `components/OnboardingHero.tsx` for title and circles layout
  - [ ] Create `components/TopNav.tsx` for navigation tabs (visual only, no functionality)

- [ ] Task 7: Accessibility implementation (AC: 23, 24, 25, 26)
  - [ ] Add ARIA labels to all interactive elements
  - [ ] Ensure error messages have `role="alert"`
  - [ ] Test keyboard navigation (Tab key moves through elements)
  - [ ] Test Enter/Space key activation on focused elements

- [ ] Task 8: Visual design polish (AC: 1, 2, 3, 4, 27)
  - [ ] Match reference design `docs/image/Landing-page.png`
  - [ ] Fine-tune spacing, colors, and typography
  - [ ] Verify circular arrangement of colored circles
  - [ ] Ensure 90%+ visual similarity to reference

- [ ] Task 9: Testing and validation (AC: 28, 29, 30)
  - [ ] Test with all 4 company names (Lactalis, Columbia, Decathlon, McCormick)
  - [ ] Test case-insensitive input (LACTALIS, lactalis, Lactalis)
  - [ ] Test invalid company names
  - [ ] Check browser console for errors/warnings
  - [ ] Run TypeScript compiler: `npm run build`
  - [ ] Test in Chrome, Safari, Firefox (desktop only)

- [ ] Task 10: CLI regression testing (AC: 17)
  - [ ] Verify Python pipeline still works: `python scripts/run_pipeline.py --brand lactalis-canada --input data/test-inputs/savannah-bananas.pdf`
  - [ ] Verify YAML files unchanged: `cat data/brand-profiles/lactalis-canada.yaml`

---

## Dev Notes

### Existing System Integration
- **Integration Point:** Reads existing brand profile YAML files from `/data/brand-profiles/`
- **File Format:** YAML with fields: `brand_name`, `country`, `industry`, `positioning`, `product_portfolio`, `target_customers`, `strategic_priorities`, `brand_values`
- **No Changes:** YAML files must remain unchanged - Python CLI pipeline depends on them
- **Technology Stack:** Next.js 15 (App Router), React 19, TypeScript 5.x, Tailwind CSS 3.x

### Route Structure
- **Root Route:** `app/page.tsx` - Combined onboarding/landing page (NOT `/onboarding` route)
- **API Route:** `app/api/onboarding/set-company/route.ts` - Company loading endpoint
- **Next Route:** `/upload` - Upload page (Story 1.3)

### Cookie Configuration
- **Name:** `company_id`
- **Value:** One of: `lactalis-canada`, `mccormick-usa`, `columbia-sportswear`, `decathlon`
- **Settings:** httpOnly=true, maxAge=604800 (7 days), sameSite='lax', path='/'
- **Purpose:** Persists company context across pages without authentication system

### Component Architecture
```
app/
  page.tsx                     # Root route - landing page
  api/
    onboarding/
      set-company/
        route.ts               # POST endpoint for company loading
components/
  OnboardingHero.tsx           # Title and circles layout
  TopNav.tsx                   # Navigation tabs (visual only)
  CompanyInput.tsx             # Input field with validation
```

### Dependencies
- `yaml` package: For parsing YAML files
- `next/headers`: For cookie management
- `fs/promises`: For reading YAML files from filesystem

### Visual Design Reference
- Reference image: `docs/image/Landing-page.png`
- Colors: Teal (#14B8A6), Blue (#3B82F6), Yellow (#FBBF24), Orange (#F97316)
- Background: Light gray/off-white (#F9FAFB or #F3F4F6)
- Font: System font stack (Tailwind default)

### Company Mapping
```typescript
const companyMapping: Record<string, string> = {
  'lactalis': 'lactalis-canada',
  'columbia': 'columbia-sportswear',
  'decathlon': 'decathlon',
  'mccormick': 'mccormick-usa'
}
```

### Error Handling
- **Invalid Company Name:** Display error message below input (no redirect)
- **Missing YAML File:** Return 500, display generic error
- **Malformed YAML:** Return 500, log error server-side
- **Network Error:** Display "Network error. Please try again."

### Testing

#### Test File Location
- Manual testing only (no automated tests for hackathon scope)
- Test checklist in Tasks section

#### Testing Standards
- **Browser Support:** Chrome, Safari, Firefox (latest versions, desktop only)
- **Accessibility:** WCAG 2.1 AA compliance (keyboard navigation, ARIA labels, screen reader support)
- **TypeScript:** Zero compilation errors (`npm run build` must pass)
- **Console:** No errors or warnings in browser console

#### Testing Frameworks and Patterns
- No automated tests required for Story 1.1
- Manual testing checklist in Task 9
- CLI regression testing in Task 10

#### Specific Testing Requirements
1. Test all 4 company names with various capitalizations
2. Test invalid company names (e.g., "invalid", "test", "")
3. Verify cookie persists after page refresh
4. Test keyboard navigation (Tab, Enter keys)
5. Verify Python CLI pipeline still works unchanged

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-19 | 1.0 | Initial story creation using BMAD template | John (PM Agent) |

---

## Dev Agent Record

### Agent Model Used

*To be populated by dev agent during implementation*

### Debug Log References

*To be populated by dev agent during implementation*

### Completion Notes List

*To be populated by dev agent during implementation*

### File List

*To be populated by dev agent during implementation*

Expected files:
- `app/page.tsx`
- `app/api/onboarding/set-company/route.ts`
- `components/OnboardingHero.tsx`
- `components/TopNav.tsx`
- `components/CompanyInput.tsx`

---

## QA Results

*To be populated by QA agent after implementation*
